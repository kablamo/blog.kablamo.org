<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>My contribution to the Linux ate my RAM problem</title>
  <meta name="description" content="I can never remember how to know how much free memory I have.">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="http://blog.kablamo.org/2013/11/12/linux_ate_my_ram/">
  <link rel="alternate" type="application/rss+xml" title="kablamo" href="http://blog.kablamo.org/feed.xml" />
</head>


  <body>

    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="/">blog.<span class="site-title-bold">kablamo</span>.org</a>

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>

      <div class="trigger">
          <a class="page-link" href="/about">About</a>
          <a class="page-link" href="/categories/perl">Perl</a>
          <a class="page-link" href="/categories/experiments">Experiments</a>
          <a class="page-link" href="/talks">Talks</a>
          <a class="page-link" href="/reading-list">What I'm reading</a>
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      </div>
    </nav>

  </div>

</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="post">

  <header class="post-header">
    <h1 class="post-title">My contribution to the Linux ate my RAM problem</h1>
    <p class="post-meta">
    
      <a href="/categories/bash">bash</a>&nbsp;
    
    &nbsp;&nbsp;
    2013-11-12
    </p>
  </header>

  <article class="post-content">
    <p>I can never remember how to know how much free memory I have.</p>

<p>The Linux kernel claims most of the operating system’s memory.  That doesn’t
mean the operating system is out of memory.  It means the kernel has claimed it
and is managing it.  The problem is that the Linux kernel defines ‘free’ memory
differently than any reasonable user.  There are excellent shiny reasons for
that, but as a user I don’t really care.</p>

<pre><code>~ ⚡ free -m 
            total       used       free     shared    buffers     cached
Mem:          3822       2066       1755          0        147       1125
-/+ buffers/cache:        793       3029
Swap:         3394          0       3394
</code></pre>

<p>Experienced users and sysadmins will know from this means my system currently
has 3822 MB of total memory and 3029 MB of free memory.  Errr.  What?  See
<a href="http://www.linuxatemyram.com">linuxatemyram.com</a> for a more detailed
explanation.</p>

<p>I think the world deserves something easier to deal with.  So I wrote ‘mem’.
Use it like this:</p>

<pre><code>~ ⚡ mem
   927 MB used (24%)
  3823 MB total
</code></pre>

<p>Its a bash function.  I put the following in my
<a href="https://github.com/kablamo/dotfiles/blob/master/links/.bash/aliases.sh">.bashrc</a>:</p>

<pre><code>mem() {
    memfree=$( grep '^MemFree:' /proc/meminfo | awk '{ mem=($2)/(1024) ; printf "%0.0f", mem }' )
    buffers=$( grep '^Buffers:' /proc/meminfo | awk '{ mem=($2)/(1024) ; printf "%0.0f", mem }' )
    cached=$(  grep '^Cached:'  /proc/meminfo | awk '{ mem=($2)/(1024) ; printf "%0.0f", mem }' )
    free=$( echo $memfree+$buffers+$cached | bc -l )

    total=$( grep '^MemTotal:' /proc/meminfo | awk '{ mem=($2)/(1024) ; printf "%0.0f", mem }' )
    used=$( echo $total-$free | bc -l )
    pct=$( echo 100*$used/$total | bc -l )

    printf "%5.f MB used (%.0f%%)\n%5.f MB total\n" $used $pct $total
}
</code></pre>

<p>See also ‘htop’ (sudo apt-get install htop).</p>

  </article>


  <section>
    <div id="disqus_thread" aria-live="polite">
        <noscript>Please enable JavaScript to view the 
            <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a>
        </noscript>
    </div>
  </section>


</div>


<script type="text/javascript">
      var disqus_shortname = 'kablamo';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://blog.kablamo.org/2013/11/12/linux_ate_my_ram/';
        var disqus_url = 'http://blog.kablamo.org/2013/11/12/linux_ate_my_ram/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


      </div>
    </div>

    

  </body>

</html>
