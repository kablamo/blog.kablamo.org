<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: perl | KABLAMO]]></title>
  <link href="http://blog.kablamo.org/categories/perl/atom.xml" rel="self"/>
  <link href="http://blog.kablamo.org/"/>
  <updated>2014-03-16T21:16:05-05:00</updated>
  <id>http://blog.kablamo.org/</id>
  <author>
    <name><![CDATA[Eric Johnson]]></name>
    <email><![CDATA[kablamo@kablamo.org]]></email>
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[How to disagree with an interviewer]]></title>
    <link href="http://blog.kablamo.org/2014/03/16/disagree-interview/"/>
    <updated>2014-03-16T00:00:00-05:00</updated>
    <id>http://blog.kablamo.org/2014/03/16/disagree-interview</id>
    <content type="html"><![CDATA[<p>Today I&rsquo;m writing about something I noticed while doing interviews recently.</p>

<p>If I disagree with a decision a company made, I need to jump into that with
both feet.  There is sometimes an instinct to say &ldquo;I suppose I can live with
that&rdquo; or &ldquo;I don&rsquo;t know enough about why this choice was made to complain about
it&rdquo;.  But the goal is not to complain or to highlight their ignorance or to
have an argument.</p>

<p>Disagreeing starts a discussion.  This creates an opportunity to do 2 things.</p>

<p>First, it allows me to show case what I know.  The fact I have an opinion shows
I have worked on this problem before and over the course of the discussion I
will be able to demonstrate I understand the pros and cons of the different
options and have expertise there.</p>

<p>Second, I will come to understand why the company got into the position they
are in.  Usually there is a good reason.  If it was made through ignorance I
will find out if are they open to fixing the problem &mdash; subject to priorities
of course.  I may also learn if they are interested in my opinion or are
looking for a soldier who follows orders.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Questions I ask in interviews]]></title>
    <link href="http://blog.kablamo.org/2014/03/14/interview-questions/"/>
    <updated>2014-03-14T00:00:00-05:00</updated>
    <id>http://blog.kablamo.org/2014/03/14/interview-questions</id>
    <content type="html"><![CDATA[<p>I recently relocated from London to the Chicago area so I have been doing
interviews.  When I interview a potential client or employer I carry this list of
questions with me.  Most of the questions I have taken from other sources
online.  I have listed them in roughly the order I ask them.</p>

<h1>Understanding the job</h1>

<ul>
<li>What will I be doing every day (precisely)?</li>
<li>Why are you hiring? New product? Scaling? Someone quit?</li>
<li>Who will I report to?</li>
<li>Who will I be working with?  How big are the teams?</li>
<li>What are my boss' goals for the next 6 months/year?</li>
<li>What is the key metric for the company? For my group? For my boss?</li>
</ul>


<h1>Understanding the culture</h1>

<ul>
<li>How do you build software?  Where do requirements and features come from?
Is it a very formal process or is there no process?</li>
<li>What problems does the group have that need to be solved?</li>
<li>Is there a mandate to fix legacy code and problems that exist?</li>
<li>What do you wish you had known before starting work here?</li>
<li>Whats the worst part of this job and whats the coolest thing you have built here, personally?</li>
</ul>


<h1>Tools and best practices</h1>

<ul>
<li>What tools are being used?

<ul>
<li>bug tracking</li>
<li>version control</li>
<li>which version of Perl</li>
<li>what operating system</li>
<li>why were those choices made</li>
</ul>
</li>
<li>Is there a mandate to use the latest stuff from CPAN?</li>
<li>Are there tests?</li>
<li>Are there automated tests?</li>
<li>What is deployment like?</li>
<li>Is Moose used? OO?</li>
</ul>


<h1>Miscellaneous</h1>

<ul>
<li>Is there any allowance for remote work?</li>
<li>Are there core business hours?</li>
<li>Will I be oncall?</li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[How to build a Duck Duck Go instant answer]]></title>
    <link href="http://blog.kablamo.org/2014/02/28/duckduckgo/"/>
    <updated>2014-02-28T00:00:00-06:00</updated>
    <id>http://blog.kablamo.org/2014/02/28/duckduckgo</id>
    <content type="html"><![CDATA[<p>Instant answers are those little boxes at the top of the DuckDuckGo search
results page.  I made one for discovering international calling codes &mdash; or
dialing codes if you prefer.</p>

<p><img src="/images/for-posts/2014-02-28-singapore.png" width="700" height="424">
<img src="/images/for-posts/2014-02-28-down-under.png" width="700" height="424"></p>

<p>If you want to hack on DuckDuckGo and add your own instant answer its pretty
simple to <a href="http://duckduckhack.com">get started</a>.  You can use Vagrant and
VirtualBox to get a complete working dev environment.  But if you are already
running Ubuntu or OSX the following recipe is easier:</p>

<pre><code>curl http://duckpan.org/install.pl | perl 
cpanm App::DuckPAN
duckpan installdeps # installs dependencies from DuckPAN (not CPAN) to locallib
</code></pre>

<p>Next fork the repository you want to hack on.  To choose the correct repository
think about what kind of data source you are using to generate your instant answer.</p>

<ul>
<li> Fork the <a href="https://github.com/duckduckgo/zeroclickinfo-spice">spice repo</a>
 if you have a real time data source like a JSON web API.</li>
<li> Fork the <a href="https://github.com/duckduckgo/zeroclickinfo-goodie">goodie repo</a>
 if you generate your instant answer with code and need no network access.</li>
<li> Fork the <a href="https://github.com/duckduckgo/zeroclickinfo-fathead">fathead repo</a>
 if your data source can be placed in a key/value store.</li>
<li> Fork the <a href="https://github.com/duckduckgo/zeroclickinfo-fathead">longtail repo</a>
 if your data source requires a full text search.</li>
</ul>


<p>Now you can start hacking.  I&rsquo;ll show you how the capitalization instant answer
from the goodie repo works.  Below is the code.  I added comments to explain
things a bit.</p>

<pre><code>package DDG::Goodie::Capitalize;
use DDG::Goodie;

# If a DuckDuckGo search query contains any of these words at the start or
# end of the query, the 'remainder' handler below will run.
triggers startend =&gt; 'capitalize', 'uppercase', 'upper case';

# This block of code is pretty much meta data describing this instant
# answer.  Mostly it is used by https://duckduckgo.com/goodies.
zci answer_type =&gt; "capitalize";
primary_example_queries 'capitalize this';
secondary_example_queries 'uppercase that';
description 'capitalize a string';
name 'Capitalize';
code_url 'https://github.com/duckduckgo/zeroclickinfo-goodies/blob/master/lib/DDG/Goodie/Capitalize.pm';
category 'conversions';
topics 'programming';
attribution twitter =&gt; 'crazedpsyc',
            cpan    =&gt; 'CRZEDPSYC' ;

# This is is where the magic happens.  $_ contains the query minus the
# trigger word.  The return value from this sub shows up on the DuckDuckGo
# search results page as an instant answer.
handle remainder =&gt; sub { uc ($_) };
</code></pre>

<p>To test your new instant answer you can launch a little web server with the following command:</p>

<pre><code>duckpan server
</code></pre>

<p>Then open your favorite web browser and surf to
<a href="http://0:5000/?q=capitalize+aliens+smell+better+than+dinosaurs">http://0:5000/?q=capitalize+aliens+smell+better+than+dinosaurs</a> and you should
see something like this:</p>

<p><img src="/images/for-posts/2014-02-28-capitalize.png" width="700" height="424"></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[I made a Readline cheat sheet]]></title>
    <link href="http://blog.kablamo.org/2014/01/01/readline-cheat-sheet/"/>
    <updated>2014-01-01T00:00:00-06:00</updated>
    <id>http://blog.kablamo.org/2014/01/01/readline-cheat-sheet</id>
    <content type="html"><![CDATA[<p>Recently Ovid pointed out <a href="http://blogs.perl.org/users/ovid/2014/01/ditching-a-language.html">large projects are much more likely to fail</a>.
I have a few large goals I&rsquo;d like to accomplish.  For example I want to improve
my front end design skills.  Rather than trying to tackle this problem all
at once, I made up a small project for myself.</p>

<p>I created a <a href="http://readline.kablamo.org/emacs.html">Readline cheat sheet</a> and
I was able to complete this project in about a day.  Here are some
of the things I learned:</p>

<ul>
<li><p><strong>Bootstrap</strong> &ndash; I always worry libraries and frameworks like
<a href="http://getbootstrap.com">Bootstrap</a> are overkill and bloat since I only need
a tiny portion of their features.  But its undeniable that I was able to quickly
build a responsive mobile friendly website without needing to worry about the
technical details.</p></li>
<li><p><strong>Readline commands</strong> &ndash; If I had to pick one keyboad shortcut to recommend it
would be <code>Ctrl-r</code> which allows you to search backwards through your
history.  I also like the incremental undo command: <code>Ctrl-_</code>.</p></li>
<li><p><strong>Text::Xslate</strong> &ndash; People keep mentioning
<a href="https://metacpan.org/pod/Text::Xslate">Text::Xslate</a> so I wanted to give it a try.
The docs say its full featured and very fast.  I liked that HTML metacharacters
are escaped by default to avoid cross site scripting attacks.  Also it supports
Template Toolkit syntax.  I didn&rsquo;t find any new killer features, but it was a
pleasure to work with.</p></li>
<li><p><strong>Some new <a href="http://helabs.com.br/blog/2014/01/21/prevent-common-problems-when-writing-css-from-scratch/">CSS tricks</a></strong> &ndash;
The best trick I learned is how to keep my footer at the bottom of the page
even when it has only a few lines of content.</p></li>
</ul>


<p>I was able to practice design, layout, color, and font selection.  And who
knows &mdash; perhaps this project will also drive a tiny bit of traffic to my
github profile and increase my
<a href="http://www.codusoperandi.com/posts/increasing-your-luck-surface-area">luck surface area</a>.</p>

<p>The momentum feels good.  I need to remember to keep my projects small more often.</p>

<p><img src="/images/for-posts/2014-02-02.png" width="700" height="424"></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Salt and pepper - How to encrypt database passwords]]></title>
    <link href="http://blog.kablamo.org/2013/12/18/authen-passphrase/"/>
    <updated>2013-12-18T00:00:00-06:00</updated>
    <id>http://blog.kablamo.org/2013/12/18/authen-passphrase</id>
    <content type="html"><![CDATA[<p>To explain how salt and pepper work in encryption, I will walk through a few
scenarios.</p>

<h1>No salt</h1>

<p><strong>Summary for the impatient:</strong>  <em>Using no salt means an attacker doesn&rsquo;t need
to generate a rainbow table because they can reuse an existing one.</em></p>

<p>If an attacker obtains my database of encrypted passwords it will be very time
consuming to brute force them.  However there exist pre-computed tables of
encrypted values of thousands of commonly used passwords.  These tables are called
rainbow tables.  It is computationally inexpensive to match the encrypted
values in a rainbow table with the encrypted values in my database.</p>

<h1>One salt</h1>

<p><strong>Summary for the impatient:</strong>  <em>Using the same salt for all your passwords
means an attacker must generate 1 rainbow table.</em></p>

<p>Salt is data used as an additional input to the algorthim that encrypts a
password.  If I use a salt when I encrypt a password the resulting output will
be different from someone who did not use the same salt.  That means my
attacker cannot reuse an existing rainbow table.  They must generate a new one
using the same salt I used.</p>

<p>Note that salt is usually stored as plain text in the database with the
encrypted passwords.  So the attacker usually has access to the salt.  Even so,
I have successfully made the attack more expensive.</p>

<h1>A random salt per password</h1>

<p><strong>Summary for the impatient:</strong>  <em>Using a random salt for each password means an
attacker must generate 1 rainbow table per password.</em></p>

<p>Instead of using a single salt for the entire database I can use a different
(random) salt for each user&rsquo;s password.  This means the attacker must generate
a set of rainbow tables for each password which is even more expensive.</p>

<p>Note that I also need to store the salt for each password I have generated.
This is a pain to do manually.  Happily some clever person came up with RFC
2307 which suggests a much simpler solution.</p>

<p>Instead of storing the just the encrypted password in the password column, store
a string which concatenates the salt and the encrypted password.  This may not
sound easier.  It implies the need to parse and concatenate strings.  However
this is handled for me by the encryption libraries so its 100% pain free.  Lets
see an example.</p>

<p>To encrypt the plaintext string &lsquo;pie&rsquo; use the following Perl code</p>

<pre><code>my $blowfish = Authen::Passphrase::BlowfishCrypt-&gt;new(
   passphrase  =&gt; 'pie',
   salt_random =&gt; 1,
   cost        =&gt; 16,
);

say $blowfish-&gt;as_rfc2307; 
# the output will look like this:
# {CRYPT}$2a$14$sS80d1JlF3oR6Q4UHT.9w.DIXnV0/dLQMoVBsOp2gMRT65bWvP0P2
</code></pre>

<p>That crazy <em>{CRYPT}$2a$blarblar</em> mumbo jumbo is what we will save to the db in the password
column.  However if I know what to look for, I can see the mumbo jumbo is actually
several things smushed together:</p>

<pre><code>{CRYPT} $ 2a $ 16 $ sS80d1JlF3oR6Q4UHT.9w.DIXnV0/dLQMoVBsOp2gMRT65bWvP0P2
</code></pre>

<ul>
<li><strong>{CRYPT}</strong> &ndash; This is the scheme identifier.  It indicates which scheme is being used
so I know how to parse the rest of the string.</li>
<li><strong>$</strong> &ndash; These are field separators</li>
<li><strong>2a</strong> &ndash; A version number for this scheme</li>
<li><strong>16</strong> &ndash; The cost</li>
<li>Then there is the <strong>salt</strong> (22 base 64 digits &mdash; plain text)</li>
<li>Followed by the <strong>encrypted password</strong> (31 base 64 digits)</li>
</ul>


<p>To check if a user has submitted a valid <code>$password</code>  use the following code</p>

<pre><code>my $secret   = ''{CRYPT}$2a$16$sS80d1JlF3oR6Q4UHT.9w.DIXnV0/dLQMoVBsOp2gMRT65bWvP0P2';
my $blowfish = Authen::Passphrase-&gt;from_rfc2307($secret);

if ($blowfish-&gt;match($password)) {
    say "You may enter";
}
else {
    say "You did not say the magic word";
}
</code></pre>

<p>Of course we want to build this into our ORM so the Authen::Passphrase objects
are inflated and deflated for us.  Here is what that looks like in a DBIx
Result class:</p>

<pre><code>__PACKAGE__-&gt;load_components(qw/FilterColumn/);
__PACKAGE__-&gt;filter_column( password =&gt; {
    filter_to_storage   =&gt; sub { $_[1]-&gt;as_rfc2307() },                      # deflate
    filter_from_storage =&gt; sub { Authen::Passphrase-&gt;from_rfc2307($_[1]) },  # inflate
});
</code></pre>

<p>But I only showed you that so you would understand what
DBIx::Class::InflateColumn::Authen::Passphrase does under the covers.  I use
that because it makes my code simpler:</p>

<pre><code>__PACKAGE__-&gt;load_components(qw/InflateColumn::Authen::Passphrase/);
__PACKAGE__-&gt;add_columns(
    ...,
    password =&gt; {
        data_type          =&gt; 'text',
        inflate_passphrase =&gt; 'rfc2307',
    },
    ...,
);
</code></pre>

<p>This is how I encrypt passwords on <a href="https://networthify.com">networthify.com</a>
and <a href="http://iijo.org">iijo.org</a>.</p>

<h1>Adding pepper</h1>

<p><strong>Summary for the impatient:</strong>  <em>Using pepper means an attacker must generate
many rainbow tables per password. But few people use pepper and its
controversial.</em></p>

<p>Pepper is the same as salt except that I don&rsquo;t save the value anywhere.  Lets
say I choose an 8 bit value for my pepper.  That means there are 256
possible values.  If I don&rsquo;t save that value anywhere then when a user logs
in I will need to try up to 256 values to see if the user has the right
password.  However it means my attacker will need to generate up to 256
rainbow tables for each password.</p>

<p>One big problem is that trying 256 possible values is going to take me about 4
minutes on average hardware.</p>

<p>Even if I ignore that issue, this option is controversial and my understanding
is that few people do it.  It is generally accepted that messing about with
salt and pepper should be left to the professionals who are writing the
encryption libraries.  Pepper is not supported by Authen::Passphrase.</p>

<h1>Caveats</h1>

<p>Salting is done to make rainbow tables inneffective.  For various reasons
crackers rarely use rainbow tables anymore.  Instead they use sophisticated
brute force algorithms which combine dictionary attacks with databases of known
or commonly used passwords.  These kinds of brute force attacks can often crack
battery-horse-staple <a href="http://xkcd.com/936/">XKCD</a> style passwords even if they
are very long.  Password are not secure unless they are very long <em>and</em>
very random.</p>

<p>And there is more bad news.  While salting makes it harder to crack all the
passwords in the database, cracking a single targeted password is often not
computationally hard.  A single completely random 8 character password can be
cracked with brute force in 10 days.</p>

<p>The only way to protect your users is to require very long and very random
passwords.  Make sure your website requires a minimum password length of 8
characters or more.</p>

<h4>Sources</h4>

<ul>
<li><a href="http://www.wired.co.uk/news/archive/2013-05/28/password-cracking/viewall">Anatomy of a hack: even your &lsquo;complicated&rsquo; password is easy to crack</a> (Wired magazine)</li>
<li><a href="https://metacpan.org/pod/Authen::Passphrase">Authen::Passphrase</a></li>
<li><a href="https://metacpan.org/pod/Authen::Passphrase::BlowfishCrypt">Authen::Passphrase::BlowfishCrypt</a></li>
<li><a href="https://metacpan.org/pod/DBIx::Class::InflateColumn::Authen::Passphrase">DBIx::Class::InflateColumn::Authen::Passphrase</a></li>
<li><a href="http://blog.afoolishmanifesto.com/archives/1910">frew</a></li>
<li><a href="http://crypto.stackexchange.com/questions/1776/can-you-help-me-understand-what-a-cryptographic-salt-is">crypto.stackexchange.com</a></li>
<li><a href="http://security.stackexchange.com/questions/3272/password-hashing-add-salt-pepper-or-is-salt-enough">security.stackexchange.com</a></li>
</ul>

]]></content>
  </entry>
  
</feed>
