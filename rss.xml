<?xml version="1.0"?>
<rss version="2.0">
  <channel>
    <title>Kablamo</title>
    <link>http://blog.kablamo.org</link>
    <pubDate>2013-01-20 21:16:45 +0000</pubDate>
    <item>
      <title>Use Carp::Always to fix circular dependencies</title>
      <link>http://blog.kablamo.org/use-carp-always-to-fix-circular-dependencies</link>
      <pubDate>2013-01-19</pubDate>
      <description>&lt;p&gt;Circular dependencies happen when your library requires a library which
requires your library.  Here&amp;#39;s an example.  Lets say you have 2 packages:  &lt;/p&gt;

&lt;p&gt;&lt;strong&gt;AlienPlanet.pm&lt;/strong&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;package AlienPlanet;
use Moose;
use Dinosaurs;          # &amp;lt;--- Circular dependency
sub has_dinosaurs {1}
1;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;strong&gt;Dinosaurs.pm&lt;/strong&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;package Dinosaurs;
use Moose;
use AlienPlanet;        # &amp;lt;--- Circular dependency
sub has_rabies {1}
1;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;If you try to compile this, you get the following warning:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;&#x26A1; perl -c lib/AlienPlanet.pm 
Subroutine has_dinosaurs redefined at lib/AlienPlanet.pm line 5.
lib/AlienPlanet.pm syntax OK
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;In this case its obvious where the problem is.  &lt;/p&gt;

&lt;p&gt;But if the package you included, included 25 other libraries, which included
other libraries, which included your original library -- then its harder to
figure out where the circle is.&lt;/p&gt;

&lt;p&gt;Happily I discovered a good solution. First, modify &lt;strong&gt;AlienPlanet.pm&lt;/strong&gt; to look
like this:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;package AlienPlanet;
sub has_dinosaurs {1}   &amp;lt;-- swap
use Dinosaurs;          &amp;lt;-- swap
1;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Next, try compiling your code again but this time with
&lt;a href="http://perladvent.org/2011/2011-12-04.html"&gt;Carp::Always&lt;/a&gt;:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;&#x26A1; perl -MCarp::Always -c lib/AlienPlanet.pm                                                                                                            
Subroutine has_dinosaurs redefined at lib/AlienPlanet.pm line 4.
        require AlienPlanet.pm called at lib/Dinosaurs.pm line 4
        Dinosaurs::BEGIN() called at lib/AlienPlanet.pm line 4
        eval {...} called at lib/AlienPlanet.pm line 4
        require Dinosaurs.pm called at lib/AlienPlanet.pm line 5
        AlienPlanet::BEGIN() called at lib/AlienPlanet.pm line 4
        eval {...} called at lib/AlienPlanet.pm line 4
lib/AlienPlanet.pm syntax OK
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Now you&amp;#39;ve got a stack trace and its easy to see where your problem is.  All
thats left is figuring out how to solve it. (Fast solution: use
&lt;a href="https://metacpan.org/module/Class::Load"&gt;Class::Load&lt;/a&gt; in the Dinosaurs
package.)&lt;/p&gt;
</description>
    </item>
    <item>
      <title>Devel::Dwarn helps me type less</title>
      <link>http://blog.kablamo.org/devel-dwarn-helps-me-type-less</link>
      <pubDate>2012-09-05</pubDate>
      <description>&lt;p&gt;2 bajillion times a day I want to print a hashref and see whats inside.
But every time I want to do that I have to type:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;use Data::Dumper::Concise;
print Dumper $hashref;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;First of all, thats too much typing.  And second of all I keep forgetting to
delete my print statements when I check in.&lt;/p&gt;

&lt;p&gt;Happily I recently discovered
&lt;a href="https://metacpan.org/module/Devel::Dwarn"&gt;Devel::Dwarn&lt;/a&gt; on CPAN.  It is
(basically) an alias to
&lt;a href="https://metacpan.org/module/Data::Dumper::Concise"&gt;Data::Dumper::Concise&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;The name is shorter which means its slightly less typing so I am already
winning.  But thats not the best part.  Lets see how to use it.&lt;/p&gt;

&lt;p&gt;On the command line I do this:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;perl -MDevel::Dwarn codeIWantToDebug.pl
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;And then in my code I do this:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;print ::Dwarn $hashref;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;There are 2 levels of good here:&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;Less typing.&lt;/li&gt;
&lt;li&gt;When I run my code without &amp;#39;perl -M&amp;#39; I get compile time errors in all
 the places I forgot to remove &lt;code&gt;print ::Dwarn $hashref&lt;/code&gt;.&lt;/li&gt;
&lt;/ol&gt;
</description>
    </item>
    <item>
      <title>Slides from my Selenium talk at YAPCEU 2012</title>
      <link>http://blog.kablamo.org/slides-from-my-selenium-talk-at-yapceu-2012</link>
      <pubDate>2012-08-26</pubDate>
      <description>&lt;p&gt;I gave my first &lt;a href="http://act.yapc.eu/ye2012/schedule?day=2012-08-20"&gt;YAPC::EU&lt;/a&gt;
presentation this year in Frankfurt after doing a trial run at London.pm.  I
received some good questions and comments and a few new ideas.  It was a good
experience and I want to do this again.&lt;/p&gt;

&lt;p&gt;My talk introduced Selenium and common problems people have when first trying
to write Selenium tests in Perl.  I also explained how I solved many of those
problems by creating
&lt;a href="https://metacpan.org/module/Test::WWW::Selenium::More"&gt;Test::WWW::Selenium::More&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;The slides are available
&lt;a href="http://kablamo.org/selenium-2012-yapceu-slides/"&gt;online&lt;/a&gt;. Or if you need to
download them for some reason, they are hosted on
&lt;a href="https://github.com/kablamo/selenium-2012-yapceu-slides"&gt;github&lt;/a&gt;.&lt;/p&gt;
</description>
    </item>
    <item>
      <title>Test::WWW::Selenium::More</title>
      <link>http://blog.kablamo.org/test-www-selenium-more</link>
      <pubDate>2012-05-17</pubDate>
      <description>&lt;p&gt;I recently released
&lt;a href="https://metacpan.org/module/Test::WWW::Selenium::More"&gt;Test::WWW::Selenium::More&lt;/a&gt;
to CPAN.  It is a small collection of utilities to help you write Selenium
tests.  Here are some reasons to use it:&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt;It has a
&lt;a href="https://metacpan.org/module/Test::WWW::Selenium::More::Manual"&gt;manual&lt;/a&gt; which
provides a concise but fairly comprehensive howto guide to Selenium testing in
Perl.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;It uses Moose so you can more easily use roles.  For example you might want
a role for methods that deal with authentication and a role for methods that
deal with payments.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Smarter testing with methods like wait_for_jquery() and jquery_click().  You
should never sleep() in your Selenium tests because that leads to slow tests
with random failures which leads to frustration, low morale, hair pulling, and
heavy drinking.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Method chaining.  Here is what this looks like:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;use Test::Most;
use Test::WWW::Selenium::More;

Test::WWW::Selenium::More-&amp;gt;new()

-&amp;gt;note(&amp;#39;Search google&amp;#39;)
-&amp;gt;open_ok(&amp;quot;http://www.google.com&amp;quot;)
-&amp;gt;title_like(qr/Google Search/)
-&amp;gt;type_ok(&amp;#39;cat pictures&amp;#39;)
-&amp;gt;follow_link_ok(&amp;#39;Search&amp;#39;)

-&amp;gt;note(&amp;#39;Check the number of results&amp;#39;)
-&amp;gt;is_text_present_ok(&amp;#39;2 bajillion results&amp;#39;);

done_testing;
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Bugs or patches?  &lt;a href="https://github.com/kablamo/Test-WWW-Selenium-More"&gt;https://github.com/kablamo/Test-WWW-Selenium-More&lt;/a&gt;&lt;/p&gt;
</description>
    </item>
    <item>
      <title>New on CPAN - MooseX::CachingProxy</title>
      <link>http://blog.kablamo.org/new-on-cpan-moosex-cachingproxy</link>
      <pubDate>2012-05-10</pubDate>
      <description>&lt;p&gt;Last week I released &lt;a href="https://metacpan.org/module/MooseX::CachingProxy"&gt;MooseX::CachingProxy&lt;/a&gt; to CPAN.&lt;/p&gt;

&lt;p&gt;Its a small module that intercepts requests from your LWP based application.
Those requests are relayed on to the intended server unless they already exist
in the cache.&lt;/p&gt;

&lt;p&gt;To toggle on and off the caching proxy, MooseX::CachingProxy provides the
attribute &amp;#39;caching_proxy&amp;#39;.  Here is a quick demo:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;package MyApp;
use Moose;
use WWW::Mechanize; # or any LWP based library
with &amp;#39;MooseX::CachingProxy&amp;#39;;

sub url { &amp;#39;http://example.com&amp;#39; } # required by MooseX::CachingProxy

sub download { 
    my $self = shift;
    $self-&amp;gt;start_caching_proxy;
    return WWW::Mechanize-&amp;gt;new()-&amp;gt;get($self-&amp;gt;url . &amp;#39;/foo&amp;#39;); 
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Under the covers, its a tiny Plack application that mashes up
&lt;a href="https://metacpan.org/module/Plack::Middleware::Cache"&gt;Plack::Middleware::Cache&lt;/a&gt; and &lt;a href="https://metacpan.org/module/Plack::App::Proxy"&gt;Plack::App::Proxy&lt;/a&gt;.&lt;/p&gt;
</description>
    </item>
    <item>
      <title>New on CPAN - Log::JSON</title>
      <link>http://blog.kablamo.org/new-on-cpan-log-json</link>
      <pubDate>2012-04-29</pubDate>
      <description>&lt;p&gt;I released Log::JSON v0.001 to CPAN today.  Its a very simple JSON logger.&lt;/p&gt;

&lt;p&gt;The advantage of a JSON logger is that a human can open a mysterious new log
file and quickly decipher the content because each piece of information is
labeled.  Using JSON also means that parsing the log file and reviving the data
structures is trivial.&lt;/p&gt;

&lt;p&gt;Here is some example usage for you:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;use Log::JSON;
my $logger = Log::JSON-&amp;gt;new(
    file            =&amp;gt; &amp;#39;/path/errorlog.json&amp;#39;, # required
    date            =&amp;gt; 1, # optional
    remove_newlines =&amp;gt; 1, # optional
);
$logger-&amp;gt;log(a =&amp;gt; 1, b =&amp;gt; 2);
# &amp;#39;/path/errorlog.json&amp;#39; now contains:
# {&amp;quot;__date&amp;quot;:&amp;quot;2010-03-28T23:15:52Z&amp;quot;,&amp;quot;a&amp;quot;:1,&amp;quot;b&amp;quot;:1}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;I wish I had written it as a Log::Dispatch plugin, and perhaps I&amp;#39;ll get around
to that sometime.&lt;/p&gt;

&lt;p&gt;One problem with using JSON is that there is a lot repetition and if your log
file is a bajillion lines long, then that&amp;#39;s going to be a big file.  Happily,
file compression solves this problem very well.  And Vim and less handle
compressed files on the fly so viewing the file is not inconvenient.  And now
that I write this, I think some kind of compression feature may be nice for
Log::JSON and pretty great for Log::Dispatch too.&lt;/p&gt;

&lt;p&gt;Log::JSON on github: &lt;a href="https://github.com/kablamo/Log-JSON"&gt;https://github.com/kablamo/Log-JSON&lt;/a&gt;&lt;/p&gt;
</description>
    </item>
  </channel>
</rss>
